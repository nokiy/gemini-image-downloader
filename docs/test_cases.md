# Gemini Image Downloader - 测试用例

> 📅 版本：v1.0  
> 📅 创建时间：2025-12-23

---

## 测试环境

| 项目 | 要求 |
|------|------|
| 浏览器 | Chrome 最新稳定版 |
| 测试页面 | https://gemini.google.com/app |
| 前置条件 | 已登录 Google 账号 |

## v1.0.0.0 手动测试清单（需用户执行）

- [ ] TC-2.1 单图下载
- [ ] TC-2.2 多图下载
- [ ] TC-2.3 高清验证（原始 URL）
- [ ] TC-3.6 页面未就绪重试

---

## M1 - 基础功能测试

### TC-1.1 插件安装验证
| 项目 | 内容 |
|------|------|
| **前置条件** | 已加载扩展程序 |
| **测试步骤** | 1. 打开 `chrome://extensions/` <br> 2. 确认插件显示在列表中 <br> 3. 确认插件图标显示在工具栏 |
| **预期结果** | 插件正常加载，图标可见 |

### TC-1.2 Popup 界面显示
| 项目 | 内容 |
|------|------|
| **前置条件** | 已安装插件，打开 Gemini 页面 |
| **测试步骤** | 1. 点击工具栏插件图标 |
| **预期结果** | Popup 界面正常弹出，显示「下载所有图片」按钮 |

### TC-1.3 图片检测 - 有图片
| 项目 | 内容 |
|------|------|
| **前置条件** | 当前对话已生成至少1张图片 |
| **测试步骤** | 1. 点击插件图标 |
| **预期结果** | 显示「找到 X 张图片」 |

### TC-1.4 图片检测 - 无图片
| 项目 | 内容 |
|------|------|
| **前置条件** | 当前对话没有生成图片 |
| **测试步骤** | 1. 点击插件图标 |
| **预期结果** | 显示「未找到图片」，下载按钮禁用或提示 |

---

## M2 - 下载功能测试

### TC-2.1 单图下载
| 项目 | 内容 |
|------|------|
| **前置条件** | 对话中有1张图片 |
| **测试步骤** | 1. 点击「下载所有图片」 |
| **预期结果** | 下载 ZIP 文件，内含1张图片 |

### TC-2.2 多图下载
| 项目 | 内容 |
|------|------|
| **前置条件** | 对话中有3张以上图片 |
| **测试步骤** | 1. 点击「下载所有图片」 |
| **预期结果** | 下载 ZIP 文件，内含所有图片，数量正确 |

### TC-2.3 高清验证
| 项目 | 内容 |
|------|------|
| **前置条件** | 下载完成 |
| **测试步骤** | 1. 解压 ZIP <br> 2. 查看图片分辨率 <br> 3. 与页面预览对比清晰度 |
| **预期结果** | 图片分辨率满足页面提供的最高质量版本（非缩略图） |

### TC-2.4 命名规则验证
| 项目 | 内容 |
|------|------|
| **前置条件** | 下载完成 |
| **测试步骤** | 1. 查看 ZIP 文件名 <br> 2. 解压查看图片文件名 |
| **预期结果** | ZIP: `Gemini_image.zip` <br> 图片: `01.{ext}`, `02.{ext}`... |

---

## M3 - 边界情况测试

### TC-3.1 非 Gemini 页面
| 项目 | 内容 |
|------|------|
| **前置条件** | 当前标签页为其他网站 |
| **测试步骤** | 1. 点击插件图标 |
| **预期结果** | 显示提示「请在 Gemini 页面使用」或不响应 |

### TC-3.2 超长对话标题
| 项目 | 内容 |
|------|------|
| **前置条件** | 对话标题超过30个字符 |
| **测试步骤** | 1. 下载图片 |
| **预期结果** | 标题被截断，文件名不超过合理长度 |

### TC-3.3 特殊字符标题
| 项目 | 内容 |
|------|------|
| **前置条件** | 对话标题包含 `/ \ : * ? " < > |` |
| **测试步骤** | 1. 下载图片 |
| **预期结果** | 特殊字符被替换为下划线，文件名合法 |

### TC-3.4 网络异常
| 项目 | 内容 |
|------|------|
| **前置条件** | 下载过程中断网 |
| **测试步骤** | 1. 开始下载 <br> 2. 中途断网 |
| **预期结果** | 提示错误信息，不崩溃 |

### TC-3.5 多轮对话图片
| 项目 | 内容 |
|------|------|
| **前置条件** | 对话中有多轮生成的图片 |
| **测试步骤** | 1. 下载图片 |
| **预期结果** | 所有轮次的图片都被下载 |

### TC-3.6 页面未就绪重试
| 项目 | 内容 |
|------|------|
| **前置条件** | 页面刚打开或扩展刚安装未刷新 |
| **测试步骤** | 1. 立即打开 Popup <br> 2. 点击「重新检测」 |
| **预期结果** | 10 秒内自动检测（每 2 秒重试），超时后提示未找到图片 |

---

## 测试结果记录

| 用例编号 | 测试日期 | 测试人 | 结果 | 备注 |
|----------|----------|--------|------|------|
| TC-1.1 | 2025-12-23 | Agent | ✅ 通过 | 插件正常加载 |
| TC-1.2 | 2025-12-23 | Agent | ✅ 通过 | Popup 界面显示正常 |
| TC-1.3 | 2025-12-23 | Agent | ✅ 通过 | 检测到 5 张图片 |
| TC-1.4 | 2025-12-23 | Agent | ✅ 通过 | 无图片时显示「未找到图片」 |
| TC-2.1 | 2025-12-23 | 待用户 | 待测 | 需手动点击下载验证 |
| TC-2.2 | 2025-12-23 | 待用户 | 待测 | 需手动点击下载验证 |
| TC-2.3 | 2025-12-23 | Agent | ⚠️ 需复测 | v1.1 改为保留原始 URL，需验证分辨率 |
| TC-2.4 | 2025-12-23 | Agent | ✅ 通过 | 标题提取正常：`生成一张可爱的猫咪图片` |
| TC-3.1 | 2025-12-23 | Agent | ✅ 通过 | 非 Gemini 页面正确识别 |
| TC-3.2 | 2025-12-23 | Agent | ✅ 通过 | 代码已实现 truncateTitle(30) |
| TC-3.3 | 2025-12-23 | Agent | ✅ 通过 | 代码已实现 sanitizeFilename() |
| TC-3.4 | 2025-12-23 | Agent | ✅ 通过 | 代码已实现 try-catch 错误处理 |
| TC-3.5 | 2025-12-23 | Agent | ✅ 通过 | 检测到多轮对话共 5 张图片 |
| TC-3.6 | 2025-12-23 | 待用户 | 待测 | 需验证重新检测与脚本注入 |

> 📝 **备注**：TC-2.1 和 TC-2.2 需要用户手动安装插件并点击下载按钮验证
